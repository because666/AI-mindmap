# 思流图（ThinkFlowMap）使用说明

## 项目简介

思流图是一个**对话驱动的结构化思维导图系统**，以对话为核心载体、思维导图为结构化呈现的交互系统。

## 快速启动

### 1. 启动后端服务

双击运行 `start_backend.bat`，或在命令行执行：

```bash
python start_backend.py
```

后端服务将在 http://localhost:8000 运行。

### 2. 启动前端服务

双击运行 `start_frontend.bat`，或在命令行执行：

```bash
cd frontend
npm install
npm run dev
```

前端服务将在 http://localhost:5173 运行。

### 3. 配置API密钥

首次使用时需要配置智谱AI API密钥：

**方式一：环境变量**
```bash
set ZHIPUAI_API_KEY=86caae47a88e4ca48af7fab4e5991e30.BK5mPaWKGKgALsla

```

**方式二：界面配置**
启动后，在界面中配置API密钥。

### 4. 访问应用

打开浏览器访问 http://localhost:5173

## 使用指南

### 创建思维导图

1. 点击左侧"新建思维导图"按钮
2. 输入标题和描述（可选）
3. 点击"创建"

### 添加节点

1. 选中一个节点
2. 点击顶部工具栏的"添加子节点"按钮
3. 新节点将自动创建为选中节点的子节点

### 创建关系线

1. 将鼠标悬停在节点上，显示连接点
2. 从一个节点的连接点拖拽到另一个节点
3. 释放鼠标创建关系线

### 与AI对话

1. 选中一个节点
2. 在右侧对话面板输入消息
3. 按 Enter 发送（Shift+Enter 换行）
4. 查看AI回复和思考过程

### 导出思维导图

1. 在左侧列表中找到要导出的思维导图
2. 点击下载图标
3. 支持导出JSON或Markdown格式

## 核心特性

- **节点即对话**：每个节点存储完整的对话历史
- **多根节点支持**：允许同一画布创建多个独立根节点
- **分支扩展与多父节点**：一个子节点可同时归属于多个父节点
- **关系线连接**：任意两节点间建立单向或双向关系线
- **严格上下文隔离**：每个分支拥有独立AI对话上下文
- **实时导图渲染**：对话过程中导图实时更新
- **导出与持久化**：支持导出JSON、Markdown格式

## 文件结构

```
DeepMindMap/
├── backend/                 # 后端代码
│   ├── main.py             # FastAPI主入口
│   ├── models.py           # 数据模型
│   ├── ai_service.py       # AI服务
│   └── requirements.txt    # Python依赖
├── frontend/               # 前端代码
│   ├── src/
│   │   ├── components/     # React组件
│   │   ├── services/       # API服务
│   │   └── types/          # TypeScript类型
│   └── dist/               # 构建产物
├── start_backend.bat       # 后端启动脚本
├── start_frontend.bat      # 前端启动脚本
└── README.md               # 项目说明
```

## 注意事项

1. 确保Python 3.8+ 和 Node.js 18+ 已安装
2. 需要智谱AI API密钥才能使用AI对话功能
3. 后端服务必须先启动，前端才能正常连接
4. 数据存储在内存中，重启后端服务会丢失数据

## 技术支持

如有问题，请参考：
- API文档：http://localhost:8000/docs
- 项目README：README.md
